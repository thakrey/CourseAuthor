<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"
       >
       
	<context:annotation-config/>
	<context:component-scan base-package="com.lrn" />
	<tx:annotation-driven transaction-manager="lcecTransactionManager" proxy-target-class="true" />

  	<!-- process filtered properties file -->
  	<bean id="applicationProperties"
        class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    	<property name="location" value="classpath:application.properties" />     
  	</bean>

  	<!--  hibernate config -->
  	<bean id="lcecDataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource">
    	<property name="driverClass"><value>${lcec.jdbc.driverClassName}</value></property>
    	<property name="jdbcUrl"><value>${lcec.jdbc.url}</value></property>
    	<property name="user"><value>${lcec.jdbc.username}</value></property>
    	<property name="password"><value>${lcec.jdbc.password}</value></property>
    	<property name="minPoolSize"><value>10</value></property>
    	<property name="maxPoolSize"><value>50</value></property>
    	<property name="initialPoolSize"><value>5</value></property>
    	<property name="acquireIncrement"><value>1</value></property>
    	<!-- property name="preferredTestQuery"><value>SELECT 1</value></property-->
    	<property name="idleConnectionTestPeriod"><value>300</value></property>
    	<property name="debugUnreturnedConnectionStackTraces"><value>true</value></property>
    	<property name="unreturnedConnectionTimeout"><value>30</value></property>
  	</bean>
  
  	<bean id="lcecTransactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
    	<property name="dataSource">
      		<ref bean="lcecDataSource" />
    	</property>
  	</bean>
  
  	<!-- lcec DB properties -->
  	<bean id="lcecHibernateProperties" class="org.springframework.beans.factory.config.PropertiesFactoryBean">
    	<property name="properties">
      		<props>
	        	<prop key="hibernate.hbm2dll.auto">validate</prop>
	        	<prop key="hibernate.dialect">org.hibernate.dialect.Oracle10gDialect</prop>
	        	<prop key="hibernate.show_sql">false</prop>
	        	<prop key="hibernate.connection.release_mode">auto</prop>
      		</props>
    	</property>
  	</bean>
  
  	<!-- lcec session factory -->
  	<bean id="lcecSessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    	<property name="dataSource" ref="lcecDataSource" />
    	<property name="annotatedClasses">
      		<list>
		        <value>com.lrn.model.hibernate.user.User</value>
		        <value>com.lrn.model.hibernate.site.Site</value>
		        <value>com.lrn.model.hibernate.RsaKeys</value>
		        <value>com.lrn.model.hibernate.RsaKeysType</value>
		        <value>com.lrn.model.hibernate.site.SiteSettings</value>
		        <value>com.lrn.model.hibernate.curriculum.Curriculum</value>
		        <value>com.lrn.model.hibernate.user.UserCurriculum</value>
		        <value>com.lrn.model.hibernate.CompletionCertificate</value>
		        <value>com.lrn.model.hibernate.jasper.JasperAttempt</value>
		        <value>com.lrn.model.hibernate.jasper.JasperConfig</value>
		        <value>com.lrn.model.hibernate.PreBalsaReportSummary</value>
		        <value>com.lrn.model.hibernate.module.Module</value>
		        <value>com.lrn.model.hibernate.CourseLookup</value>
		        <value>com.lrn.model.hibernate.Sessions</value>
		        <value>com.lrn.model.hibernate.site.SiteConfigs</value>
		        <value>com.lrn.model.hibernate.PasswordRecover</value>
		        <value>com.lrn.model.hibernate.curriculum.CurriculumCourse</value>
		        <value>com.lrn.model.hibernate.site.SiteCourse</value>
		        <value>com.lrn.model.hibernate.curriculum.CurriculumModuleChain</value>
		        <value>com.lrn.model.hibernate.module.ModuleChainMembers</value>
		        <value>com.lrn.model.hibernate.user.UserSurveyModule</value>
		        <value>com.lrn.model.hibernate.Edition</value>
		        <value>com.lrn.model.hibernate.EditionData</value>
		        <value>com.lrn.model.hibernate.site.SiteSecretkey</value>
		        <value>com.lrn.model.hibernate.CompanyUsersColumn</value>
		        <value>com.lrn.model.hibernate.AiccCourseState</value>
		        <value>com.lrn.model.hibernate.user.UserCustomColumnEnum</value>
		        <value>com.lrn.model.hibernate.user.UserCustomColumns</value>
		        <value>com.lrn.model.hibernate.user.UserModuleLangPref</value>
		        <value>com.lrn.model.hibernate.custom.CustomPublishes</value>
		        <value>com.lrn.model.hibernate.custom.CustomSections</value>
		        <value>com.lrn.model.hibernate.custom.CustomFieldEnum</value>
		        <value>com.lrn.model.hibernate.custom.CustomString</value>
		        <value>com.lrn.model.hibernate.SrcModuleTemplate</value>
		        <value>com.lrn.model.hibernate.site.SiteBaseCatalogConfigs</value>
		        <value>com.lrn.model.hibernate.CourseEvents</value>
		        <value>com.lrn.model.hibernate.src.SrcLang</value>
      		</list>
    	</property>
    	<property name="hibernateProperties" ref="lcecHibernateProperties" />
  	</bean>              
</beans>